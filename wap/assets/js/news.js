const glossaryNews = [
		{
		"term": "é²è™ºäººå·¥æ™ºèƒ½ç½‘å·²å®Œæˆç½‘é¡µå…¼å®¹æ€§ä¼˜åŒ–",
		"content":"é²è™ºäººå·¥æ™ºèƒ½ç½‘å·²è¿›è¡Œäº†ä¸€æ¬¡å…¨é¢çš„ç½‘é¡µå…¼å®¹æ€§ä¼˜åŒ–ï¼Œç›®å‰é²è™ºäººå·¥æ™ºèƒ½ç½‘ æ”¯æŒå¤šç§ä¸åŒçš„è®¾å¤‡ã€‚ç”±äºæ­¤æ¬¡æ›´æ–°å½±å“åˆ°äº†ç½‘ç«™çš„è¯¸å¤šæ–¹é¢ï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›æœªçŸ¥çš„é¡µé¢æ’ç‰ˆé—®é¢˜ã€‚\n\nå¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•ç›¸å…³é—®é¢˜ï¼Œæ— è®ºé—®é¢˜çš„å¤§å°ï¼Œæˆ‘ä»¬éƒ½éå¸¸æ¬¢è¿æ‚¨å‘æˆ‘ä»¬åé¦ˆï¼›æ‚¨çš„æ¯ä¸€æ¬¡åé¦ˆéƒ½æ˜¯æ¨åŠ¨ é²è™ºäººå·¥æ™ºèƒ½ç½‘ è¿›æ­¥çš„é‡è¦åŠ¨åŠ›ï¼Œæˆ‘ä»¬ä¿è¯å°†å°½å¿«å¯¹æ‚¨çš„åé¦ˆè¿›è¡Œå¤„ç†å¹¶ä¼˜åŒ–ã€‚",
		"definition": "2023-05-31 15:50",
		"link": "http://ai.luhui.net/news.html"
		},
		{
		"term": "é²è™ºç»˜ç”»ç½‘ç«™AIpixæ­£å¼ä¸Šçº¿",
		"content":"ç”±äºéœ€è¦ä¿æŒæ•´ä½“UIä¸€è‡´æ€§ï¼Œé²è™ºäººå·¥æ™ºèƒ½ç½‘çš„AIç”»å»Šï¼Œè®©ä¸å°‘è®¾è®¡æ–¹é¢çš„å°ä¼™ä¼´å¯¹AIç”»å»Šçš„ç•Œé¢ä¸å¤ªæ„Ÿå†’ï¼Œç»è¿‡è·Ÿå¤§å®¶çš„æ²Ÿé€šã€‚\n\næˆ‘ä»¬æ¨å‡ºäº†ä¸“é—¨é’ˆå¯¹AIç»˜ç”»çš„ç½‘ç«™-ç†µç»˜: http://aiauu.com ï¼Œç†µç»˜åˆšä¸Šçº¿ï¼Œè¿˜æœ‰ä¸å°‘åœ°æ–¹éœ€è¦ä¼˜åŒ–ï¼Œè¿˜è¯·å¤§å®¶å¤šæå»ºè®®ï¼›ç›®å‰ä¼šæ¯å¤©æ”¶å½•midjourneyçƒ­é—¨å›¾ç‰‡ï¼Œå¹¶å¢åŠ ä¸­æ–‡æŒ‡ä»¤ï¼",
		"definition": "2023-05-30 20:30",
		"link": "http://aipix.luhui.net"
		},
		
		{
		"term": "é²è™ºäººå·¥æ™ºèƒ½ç½‘ç”¨æˆ·é—®å·è°ƒç ”ï¼Œéå¸¸æœŸå¾…æ‚¨çš„åé¦ˆ",
		"content":"é²è™ºäººå·¥æ™ºèƒ½ç½‘ è‡ªä¸Šçº¿è‡³ä»Šï¼Œè‡´åŠ›äºåœ¨ä¸æ–­ä¼˜åŒ–æ”¹è¿›ä¸­ç»™ç”¨æˆ·æä¾›æœ€ä¼˜è´¨çš„æœåŠ¡ã€‚\nä¸ºäº†ç»™æ‚¨æä¾›æ›´å¥½çš„æœåŠ¡ï¼Œå¸Œæœ›æ‚¨èƒ½æŠ½å‡ºå‡ åˆ†é’Ÿæ—¶é—´ï¼Œå°†æ‚¨çš„æ„Ÿå—å’Œå»ºè®®å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬éå¸¸é‡è§†æ¯ä½ç”¨æˆ·çš„å®è´µæ„è§ï¼ŒæœŸå¾…æ‚¨çš„å‚ä¸ï¼\n\nç‚¹å‡»åŸæ–‡é“¾æ¥å‚ä¸ï¼",
		"definition": "2023-05-23 14:00",
		"link": "http://luhui.net/zh/#s2/12327068/320d/"
		},
		
		{
		"term": "é²è™ºè½¯ä»¶æºç ç½‘ ä¸Šçº¿ æš—å¤œæ¨¡å¼ åŠŸèƒ½",
		"content":"é²è™ºäººå·¥æ™ºèƒ½ç½‘å·²ä¸Šçº¿ æš—å¤œæ¨¡å¼ åŠŸèƒ½ï¼Œæ‚¨å¯åœ¨é¡µé¢çš„å³ä¸‹è§’ç‚¹å‡»åˆ‡æ¢æ¨¡å¼ï¼Œåˆæ¬¡ä½“éªŒå¯èƒ½å­˜åœ¨ç¼“å­˜ï¼Œè¯·å¤šåˆ·æ–°å‡ æ¬¡æµè§ˆå™¨ï¼›æˆ‘ä»¬å°†æŒç»­æ”¶é›†ç”¨æˆ·æ„è§ï¼Œä¼˜åŒ–ä½¿ç”¨ä½“éªŒï¼Œå¦‚æ‚¨æœ‰å¥½çš„å»ºè®®è¯·è”ç³»æˆ‘ï¼Œå¾®ä¿¡ï¼šCryptoLifeï¼Œæ„Ÿè°¢å¤§å®¶çš„æ”¯æŒ!",
		"definition": "2023-05-22 22:30",
		"link": "http://soft.luhui.net/"
		},
		
		{
		"term": "é²è™ºäººå·¥æ™ºèƒ½ç½‘ ä¸Šçº¿ åˆ›æ„ç”»å»Š åŠŸèƒ½",
		"content":"é²è™ºäººå·¥æ™ºèƒ½ç½‘å·²ä¸Šçº¿ åˆ›æ„ç”»å»Š åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†æŒç»­æ”¶é›†å…¨ç½‘ä¼˜ç§€ç»˜ç”»åˆ›ä½œï¼Œå¦‚æ‚¨æœ‰å¥½çš„ç»˜ç”»ä½œå“å¯è”ç³»æˆ‘ä»¬æäº¤æ”¶å½•ï¼Œæ„Ÿè°¢å¤§å®¶çš„æ”¯æŒã€‚",
		"definition": "2023-05-15 14:30",
		"link": "http://ai.luhui.net/news.html"
		},
		
		{
		"term": "é²è™ºäººå·¥æ™ºèƒ½ç½‘ Promptsæ–°å¢è‹±æ–‡åŠŸèƒ½",
		"content":"è‡ª5æœˆ11æ—¥å‘èµ·ç”¨æˆ·é—®å·è°ƒç ”ä»¥æ¥ï¼Œæˆ‘ä»¬ç»Ÿè®¡äº†å¤§å®¶çš„å›ç­”ï¼Œæ ¹æ®åˆ†æï¼Œæˆ‘ä»¬æœªæ¥å‘å±•é‡ç‚¹å°†åœ¨AIå·¥å…·ã€Promptsã€åˆ›ä½œä¸“é¢˜å‡ ä¸ªåŠŸèƒ½ï¼Œåç»­å°†æŒç»­ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œæ–°å¢åŠŸèƒ½å†…å®¹ï¼›å½“å‰å·²æ”¯æŒPromptsè‹±æ–‡æŸ¥çœ‹å¤åˆ¶ï¼Œå¹¶æŒ‰ç…§ä¼˜å…ˆçº§å¯¹èœå•é‡æ–°è¿›è¡Œäº†æ’åºï¼›éå¸¸æ„Ÿè°¢å¤§å®¶çš„æ”¯æŒã€‚",
		"definition": "2023-05-12 17:20",
		"link": "http://ai.luhui.net/news.html"
		},
		
		{
		"term": "é²è™ºäººå·¥æ™ºèƒ½ç½‘1.0 æ­£å¼ä¸Šçº¿ï¼Œç”±ChatGPTä¸Palerå…±åŒç ”å‘",
		"content":"é²è™ºäººå·¥æ™ºèƒ½ç½‘ æ˜¯ä¸€æ¬¾ç®€å•æ˜“ç”¨çš„AIè¾…åŠ©å·¥å…·ï¼Œæ—¨åœ¨é™ä½äººå·¥æ™ºèƒ½æŠ€æœ¯çš„ä½¿ç”¨é—¨æ§›ï¼ŒåŠ©åŠ›æ¨åŠ¨ AI çš„æ™®åŠä¸åº”ç”¨ã€‚",
		"definition": "2023-4-29 09:20",
		"link": "http://ai.luhui.net/about.html"
		}
];

const announcementContainer = document.getElementById("announcement-container");
// è·å–åŠ è½½åŠ¨ç”»å…ƒç´ 
const loadingElement = document.getElementById("loading");

// åœ¨è¯·æ±‚RSSæ•°æ®ä¹‹å‰æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
loadingElement.style.display = "block";

function createAnnouncementElement(announcement) {
    const div = document.createElement('div');
    div.className = 'welcome active';

    const span = document.createElement('span');
    span.textContent = 'ğŸ“£ ' + announcement.term;
    div.appendChild(span);

    const welcomeLink = document.createElement('a');
    welcomeLink.href = announcement.link;
    welcomeLink.className = 'welcome-link';
    div.appendChild(welcomeLink);

    return div;
}


		// helper function to format date
		function formatDate(d) {
		    let month = '' + (d.getMonth() + 1),
		        day = '' + d.getDate(),
		        year = d.getFullYear();
		
		    if (month.length < 2) 
		        month = '0' + month;
		    if (day.length < 2) 
		        day = '0' + day;
		
		    return [year, month, day].join('-');
		}
		
		// å®šä¹‰æœç´¢çš„å…³é”®è¯
		const keywords = ["AI", "äººå·¥æ™ºèƒ½", "AIGC", "GPT", "ChatGPT", "å¤§æ¨¡å‹", "å…ƒå®‡å®™", "3D", "è™šæ‹Ÿ", "é«˜ç²¾åº¦", "OpenAi", "Midjourney", "Bing", "Prompt", "LLM", "NLP", "Stable"];
		
		function formatTime(time) {
		    let hour = '' + time.getHours();
		    let minute = '' + time.getMinutes();
		
		    if (hour.length < 2) 
		        hour = '0' + hour;
		    if (minute.length < 2) 
		        minute = '0' + minute;
		
		    return hour + ':' + minute;
		}


		async function getRssData(rssUrl) {
		  const proxyUrl = 'http://api.allorigins.win/raw?url=' + encodeURIComponent(rssUrl);
		  const response = await fetch(proxyUrl);
		  const text = await response.text();
		  const parser = new DOMParser();
		  const xmlDoc = parser.parseFromString(text, "text/xml");
		
		  const items = xmlDoc.getElementsByTagName("item");
		  const jsonItems = [];
		
		  const fifteenDaysAgo = new Date(Date.now() - 15 * 24 * 60 * 60 * 1000);  // 15å¤©å‰çš„æ—¥æœŸ
		
		  for (let i = 0; i < items.length; i++) {
		    const title = items[i].getElementsByTagName("title")[0].textContent.replace(/<em>|<\/em>/g, '');
		    const description = items[i].getElementsByTagName("description")[0].textContent.replace(/<em>|<\/em>/g, '');
		    const pubDate = items[i].getElementsByTagName("pubDate")[0].textContent;
		    let link = items[i].getElementsByTagName("link")[0].textContent;
		
		    // å¦‚æœRSSæºURLåŒ…å«"/search/newsflashes/"ï¼Œåˆ™ä½¿ç”¨æºURLä½œä¸ºåŸæ–‡é“¾æ¥
		    if (rssUrl.includes("/search/newsflashes/")) {
		      link = `http://www.36kr.com/search/newsflashes/${encodeURIComponent(title)}`;
		    }
		
		    let date = new Date(pubDate);
		
		    // å¦‚æœæ–°é—»çš„å‘å¸ƒæ—¥æœŸåœ¨15å¤©å‰ï¼Œæˆ–è€…æ–°é—»æ ‡é¢˜ä¸åŒ…å«ä»»ä½•å…³é”®è¯ï¼Œé‚£ä¹ˆè·³è¿‡è¿™ä¸ªæ–°é—»
		    if (date < fifteenDaysAgo || !keywords.some(keyword => title.includes(keyword))) continue;
		
		    let formattedTime = formatTime(date);
		    let formattedDate = formatDate(date) + ' ' + formattedTime;
		
		    const jsonItem = {
		      "term": title,
		      "content": description,
		      "definition": formattedDate,
		      "link": link
		    };
		
		    jsonItems.push(jsonItem);
		  }
		
		  return jsonItems;
		}




		
		// æ”¶é›†RSSæ•°æ®å¹¶æ’åº
		async function getAndSortRssData(rssUrl) {
		    let data = await getRssData(rssUrl);
		    
		    // æŒ‰æ—¥æœŸæ’åº
		    data.sort((a, b) => new Date(b.definition) - new Date(a.definition));
		  
		    return data;
		}
		
		
				const content = document.getElementById("announcement-containers");
				
				function renderGlossary(glossaryNews) {
				  content.innerHTML = "";
				  let previousDate = "";
				
				  glossaryNews.forEach(item => {
				    const currentDate = item.definition.split(" ")[0];
				
				    // æ£€æŸ¥ currentDate æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ—¥æœŸ
				    if (isNaN(Date.parse(currentDate))) {
				      return;  // å¦‚æœ currentDate ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ—¥æœŸï¼Œè·³è¿‡è¿™ä¸ª item
				    }
				
				    const [year, month, day] = currentDate.split("-");
				
				    if (currentDate !== previousDate) {
				      const dateDiv = document.createElement("div");
				      dateDiv.className = "date-label";
				      dateDiv.textContent = `ğŸ“… ${month}æœˆ${day}æ—¥`;
				      content.appendChild(dateDiv);
				      previousDate = currentDate;
				    }
				
				        const div = document.createElement("div");
				        div.className = "term";
				        
				        const time = item.definition.split(" ")[1];
				        const p = document.createElement("p");
				        p.innerText = time;
				
				        const h3 = document.createElement("h3");
				        h3.innerText = item.term;
				
				        // å¦‚æœå¡ç‰‡é‡è¦ï¼Œå°† term æ–‡å­—è®¾ç½®ä¸ºçº¢è‰²
				        if (item.important) {
				            h3.style.color = "red";
				        }
				
				        const contentPara = document.createElement("p");
				        contentPara.innerText = item.content;
				        contentPara.className = "content-para";
				
				        div.appendChild(p);
				        div.appendChild(h3);
				        div.appendChild(contentPara);
				        
				        if (item.link) {
				            const a = document.createElement("a");
				            a.href = item.link;
				            a.textContent = "ğŸ”— åŸæ–‡é“¾æ¥";
				            a.className = "learn-more";
				            a.target = "_blank";
				            div.appendChild(a);
				            div.addEventListener('click', function () {
				                window.open(item.link);
				            });
				        }
				
				        content.appendChild(div);
				    });
				}
		
		
		
		
		
		
				
				function filterGlossary(query) {
				    return glossaryNews.filter(item => {
				        return item.term.toLowerCase().includes(query.toLowerCase()) || item.definition.toLowerCase().includes(query.toLowerCase()) || item.content.toLowerCase().includes(query.toLowerCase());
				    });
				}
		
				
				
				const searchInput = document.getElementById('search-input');
				searchInput.addEventListener('input', updateGlossary);
				
				function updateGlossary() {
				  const query = searchInput.value;
				
				  const filteredGlossary = filterGlossary(query);
				  renderGlossary(filteredGlossary);
				}
				
				
				Promise.all([
				  getRssData('http://rsshub.app/36kr/search/newsflashes/AI'),
				  getRssData('http://rsshub.app/36kr/search/newsflashes/GPT')
				]).then(([data1, data2]) => {
				  data1.forEach(item => {
				    glossaryNews.push(item);
				  });
				
				  data2.forEach(item => {
				    glossaryNews.push(item);
				  });
				
				  // è¿›è¡Œæ’åº
				  glossaryNews.sort((a, b) => new Date(b.definition) - new Date(a.definition));
				  
				  // æ•°æ®åŠ è½½å®Œæˆåéšè—åŠ è½½åŠ¨ç”»
				    loadingElement.style.display = "none";
				
				  updateGlossary();  // æ›´æ–°é¡µé¢
				});

		